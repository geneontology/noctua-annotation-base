<div class="w-100-p">
  <div class="noc-activity-node noctua-form-table w-100-p"
    [ngClass]="{'noc-selected': activity.displayId===camsService.currentMatch?.activityDisplayId}" fxLayout="row"
    fxLayoutAlign="start stretch">
    <div class="noc-term-cell" fxLayout="column" fxLayoutAlign="start stretch" fxFlex="">
      <div class="noc-entity-cell noc-column-flex" fxLayout="column" fxLayoutAlign="start stretch"
        [attr.id]="entity.term?.displayId" [ngClass]="{'noc-highlight-match': entity.term?.highlight,
            'noc-highlight-modified': entity.term?.modified,
            'noc-highlight-match-current': entity.term?.uuid===camsService.currentMatch?.uuid}">
        <p class="noc-old-term" *ngIf="entity.term?.modified && entity.term?.termHistory?.length>0">
          {{entity.term?.termHistory[0]?.label}}
          <a (click)="$event.stopPropagation()" href="{{entity.term?.termHistory[0]?.url}}" target="_blank">
            {{ entity.term?.termHistory[0]?.id }}
          </a>
        </p>
        <p class="">
          {{entity.term?.label}} <br>
          <a (click)="$event.stopPropagation()" href="{{entity.term?.url}}" target="_blank">
            {{ entity.term?.id }}
          </a>
        </p>
        <noctua-inline-editor *ngIf="noctuaUserService.user && entity.term && options.editableTerms" [cam]="cam"
          [activity]='activity' [entity]="entity" [category]="EditorCategory.term" class="noc-edit-button">
        </noctua-inline-editor>
      </div>
    </div>
    <div class="noc-apsect-cell" fxLayout="column" fxLayoutAlign="start stretch">
      <div class="noc-entity-cell">
        <p class="">{{entity.aspect}}</p>
      </div>
    </div>
    <div class="noc-aspect-cell" fxLayout="column" fxLayoutAlign="start stretch">
      <div class="noc-entity-cell">
        <p *ngIf="entity.isExtension" class="">Yes</p>
      </div>
    </div>
    <div class="noc-evidence-cell" fxLayout="column" fxLayoutAlign="start stretch">
      <div fxFlex="" class="p-0">
        <noc-evidence-table class="w-100-p" [options]="optionsDisplay" [cam]="cam" [entity]="entity">
        </noc-evidence-table>
      </div>
    </div>
    <div class="noc-cell noc-action-cell" fxLayout="column" fxLayoutAlign="start center">
      <button mat-icon-button *ngIf="noctuaUserService.user" (click)="updateCurrentMenuEvent($event)"
        class="noc-action-button" fxFlex="40px" [matMenuTriggerFor]="entityMenu">
        <mat-icon>more_vert</mat-icon>
      </button>
      <mat-menu #entityMenu="matMenu" class="noc-dropdown-menu">
        <button mat-menu-item *ngIf="entity.treeLevel===0" class="" (click)="toggleIsComplement(entity)">
          NOT Qualifier
        </button>
        <button mat-menu-item *ngIf="entity.insertMenuNodes" [matMenuTriggerFor]="addMenu">Add</button>
        <button mat-menu-item [matMenuTriggerFor]="evidenceMenu">Evidence</button>
      </mat-menu>
      <mat-menu #addMenu="matMenu">
        <button mat-menu-item *ngFor="let insertMenuItem of entity.insertMenuNodes" class=""
          (click)="insertEntity(entity, insertMenuItem)">
          {{insertMenuItem.label}}
        </button>
      </mat-menu>
      <mat-menu #evidenceMenu="matMenu">
        <button mat-menu-item (click)="addEvidence(entity, entity.predicate?.evidenceIndex)" class="">
          Add Evidence
        </button>
        <!--   <button (click)="removeEvidence(entity,i)" mat-menu-item>
              Remove Evidence
            </button> -->
      </mat-menu>
    </div>
  </div>
</div>